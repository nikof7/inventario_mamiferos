filter(tipo_dispositivo == "camera") %>%
select(sitio, id_dispositivo, esfuerzo) %>%
select(sitio, id_dispositivo, esfuerzo) %>%
drop_na() %>%
group_by(sitio) %>%
summarize(esfuerzo = sum(esfuerzo), n_camaras_totales = n_distinct(id_dispositivo))
# Cargo esfuerzo por cámara
info_camaras <- read.csv("data/info_dispositivos.csv") %>%
filter(tipo_dispositivo == "camera") %>%
select(sitio, id_dispositivo, esfuerzo) %>%
select(sitio, id_dispositivo, esfuerzo) %>%
drop_na() %>%
group_by(sitio) %>%
summarize(esfuerzo_total = sum(esfuerzo), n_camaras_totales = n_distinct(id_dispositivo))
calculo_incidencia <- data %>%
select(sitio, camara, especie) %>%
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
group_by(sitio, especie) %>%
mutate(incidencia = num_camaras/esfuerzo)
info_camaras
calculo_incidencia <- data %>%
select(sitio, camara, especie) %>%
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
group_by(sitio, especie) %>%
mutate(incidencia = num_camaras/n_camaras_totales)
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
filter(especie == "Btau") %>%
ungroup() %>%
summarise(mean(incidencia))
paged_table(calculo_incidencia)
data %>%
select(sitio, camara, especie) %>%
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
group_by(sitio, especie) %>%
mutate(incidencia = num_camaras/n_camaras_totales)
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
filter(especie == "Btau")
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
filter(especie == "Btau") %>%
ungroup() %>%
summarise(mean(incidencia))
calculo_incidencia
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
filter(especie == "Btau") %>%
group(especie) %>%
summarise(mean(incidencia))
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
filter(especie == "Btau") %>%
group_by(especie) %>%
summarise(mean(incidencia))
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(mean(incidencia))
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(mean(incidencia)) %>%
arrange()
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = mean(incidencia)) %>%
arrange()
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = mean(incidencia)) %>%
arrange(promedio_incidencia)
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = mean(incidencia)) %>%
arrange(-promedio_incidencia)
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = mean(incidencia), desvio_incidencia = sd(incidencia)) %>%
arrange(-promedio_incidencia)
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = mean(incidencia), sd_incidencia = sd(incidencia)) %>%
arrange(-sd_incidencia)
calculo_incidencia <- data %>%
select(sitio, camara, especie) %>% # Me quedo solo con las columnas de interés
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>% # Me quedo con la cantidad de cámaras que tuvo registro de cada especie, por área protegida.
left_join(info_camaras, by = join_by(sitio)) %>% # Asocio esos datos con la información de cada cámara (esfuerzo y total de cámaras utilizadas)
group_by(sitio, especie) %>%
mutate(incidencia = (num_camaras/n_camaras_totales)*100) # Calculo incidencia
calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = mean(incidencia) , sd_incidencia = sd(incidencia)) %>%
arrange(-sd_incidencia)
paged_table(calculo_incidencia)
incidencia_por_ap <- data %>%
select(sitio, camara, especie) %>% # Me quedo solo con las columnas de interés
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>% # Me quedo con la cantidad de cámaras que tuvo registro de cada especie, por área protegida.
left_join(info_camaras, by = join_by(sitio)) %>% # Asocio esos datos con la información de cada cámara (esfuerzo y total de cámaras utilizadas)
group_by(sitio, especie) %>%
mutate(incidencia = (num_camaras/n_camaras_totales)*100) %>%  # Calculo incidencia
select(sitio, especie, incidencia)
paged_table(calculo_incidencia)
paged_table(incidencia_por_ap)
incidencia_total <- calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),3) , sd_incidencia = sd(incidencia)) %>%
arrange(-sd_incidencia)
incidencia_por_ap <- data %>%
select(sitio, camara, especie) %>% # Me quedo solo con las columnas de interés
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>% # Me quedo con la cantidad de cámaras que tuvo registro de cada especie, por área protegida.
left_join(info_camaras, by = join_by(sitio)) %>% # Asocio esos datos con la información de cada cámara (esfuerzo y total de cámaras utilizadas)
group_by(sitio, especie) %>%
mutate(incidencia = round((num_camaras/n_camaras_totales)*100, 3)) %>%  # Calculo incidencia
select(sitio, especie, incidencia)
paged_table(incidencia_por_ap)
incidencia_total <- calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),2) , sd_incidencia = sd(incidencia)) %>%
arrange(-sd_incidencia)
incidencia_total
incidencia_total <- calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),2) , sd_incidencia = round(sd(incidencia),2)) %>%
arrange(-sd_incidencia)
paged_table(incidencia_por_ap)
incidencia_total
paged_table(incidencia_total)
paged_table(incidencia_por_ap)
data
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct()
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie) %>%
summarize(n = n()) %>%
ungroup()
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie) %>%
summarize(n = n()) %>%
ungroup() %>%
spread(sitio, n, fill = 0)
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct()
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie)
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie) %>%
summarize(n = n())
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie) %>%
summarize(n = n()) %>%
ungroup() %>%
spread(sitio, n, fill = 0)
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct()
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie) %>%
summarize(n = n())
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie) %>%
summarize(n = n())
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(especie) %>%
summarize(n = n())
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
library(tidyverse)
library(rmarkdown)
load("data/planilla_general.RData")
gatos <- datos %>%
filter(is.na(type)) %>%
filter(species == "Fcat") %>%
mutate(type = "Mammal",
group = "Domestico")
datos_sin_gatosNA <- datos %>%
filter(!(is.na(type) & species == "Fcat"))
data <- datos_sin_gatosNA %>%
rbind(.,gatos) %>%
filter(type == "Mammal") %>%
select(sitio = site, camara = camera, datetime, grupo = group, especie = species)
rm(datos, datos_sin_gatosNA, gatos)
# Cargo esfuerzo por cámara
info_camaras <- read.csv("data/info_dispositivos.csv") %>%
filter(tipo_dispositivo == "camera") %>%
select(sitio, id_dispositivo, esfuerzo) %>%
select(sitio, id_dispositivo, esfuerzo) %>%
drop_na() %>%
group_by(sitio) %>%
summarize(esfuerzo_total = sum(esfuerzo), n_camaras_totales = n_distinct(id_dispositivo))
paged_table(info_camaras)
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie) %>%
summarize(n = n()) %>%
ungroup() %>%
spread(sitio, n, fill = 0)
data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(especie) %>%
summarize(n = n())
incidencia_por_ap <- data %>%
select(sitio, camara, especie) %>% # Me quedo solo con las columnas de interés
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>% # Me quedo con la cantidad de cámaras que tuvo registro de cada especie, por área protegida.
left_join(info_camaras, by = join_by(sitio)) %>% # Asocio esos datos con la información de cada cámara (esfuerzo y total de cámaras utilizadas)
group_by(sitio, especie) %>%
mutate(incidencia = round((num_camaras/n_camaras_totales)*100, 2)) %>%  # Calculo incidencia
select(sitio, especie, incidencia)
incidencia_total <- calculo_incidencia %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),2) , sd_incidencia = round(sd(incidencia),2)) %>%
arrange(-sd_incidencia)
incidencia_por_ap <- data %>%
select(sitio, camara, especie) %>% # Me quedo solo con las columnas de interés
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>% # Me quedo con la cantidad de cámaras que tuvo registro de cada especie, por área protegida.
left_join(info_camaras, by = join_by(sitio)) %>% # Asocio esos datos con la información de cada cámara (esfuerzo y total de cámaras utilizadas)
group_by(sitio, especie) %>%
mutate(incidencia = round((num_camaras/n_camaras_totales)*100, 2)) %>%  # Calculo incidencia
select(sitio, especie, incidencia)
incidencia_total <- incidencia_por_ap %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),2) , sd_incidencia = round(sd(incidencia),2)) %>%
arrange(-sd_incidencia)
paged_table(incidencia_por_ap)
paged_table(incidencia_total)
incidencia_por_ap <- data %>%
select(sitio, camara, especie) %>% # Me quedo solo con las columnas de interés
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>% # Me quedo con la cantidad de cámaras que tuvo registro de cada especie, por área protegida.
left_join(info_camaras, by = join_by(sitio)) %>% # Asocio esos datos con la información de cada cámara (esfuerzo y total de cámaras utilizadas)
group_by(sitio, especie) %>%
mutate(incidencia = round((num_camaras/n_camaras_totales)*100, 2)) %>%  # Calculo incidencia
select(sitio, especie, incidencia) %>%
arrange(-incidencia)
incidencia_total <- incidencia_por_ap %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),2) , sd_incidencia = round(sd(incidencia),2)) %>%
arrange(-promedio_incidencia)
paged_table(incidencia_por_ap)
paged_table(incidencia_total)
incidencia_total <- incidencia_por_ap %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),2) , sd_incidencia = round(sd(incidencia),2)) %>%
arrange(sitio, -promedio_incidencia)
incidencia_por_ap %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),2) , sd_incidencia = round(sd(incidencia),2))
incidencia_por_ap <- data %>%
select(sitio, camara, especie) %>% # Me quedo solo con las columnas de interés
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>% # Me quedo con la cantidad de cámaras que tuvo registro de cada especie, por área protegida.
left_join(info_camaras, by = join_by(sitio)) %>% # Asocio esos datos con la información de cada cámara (esfuerzo y total de cámaras utilizadas)
group_by(sitio, especie) %>%
mutate(incidencia = round((num_camaras/n_camaras_totales)*100, 2)) %>%  # Calculo incidencia
select(sitio, especie, incidencia) %>%
arrange(sitio, -incidencia)
incidencia_por_ap
paged_table(incidencia_por_ap)
paged_table(incidencia_total)
data %>%
```
data
data %>%
select(sitio, especie)
data %>%
select(sitio, camara, especie)
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(n())
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros <- n())
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n())
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio))
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(cantidad_de_registros/esfuerzo_total)
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tr = cantidad_de_registros/esfuerzo_total) %>%
select(sitio, especie, tr)
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tr = cantidad_de_registros/esfuerzo_total) %>%
select(sitio, especie, tr) %>%
group_by(especie) %>%
summarise(mean(tr))
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tr = cantidad_de_registros/esfuerzo_total) %>%
select(sitio, especie, tasa_registro)
data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tasa_registro = cantidad_de_registros/esfuerzo_total) %>%
select(sitio, especie, tasa_registro)
tasa_registro <- data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tasa_registro = cantidad_de_registros/esfuerzo_total) %>%
select(sitio, especie, tasa_registro) %>%
arrange(-tasa_registro)
tasa_registro
tasa_registro <- data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tasa_registro = cantidad_de_registros/esfuerzo_total) %>%
select(sitio, especie, tasa_registro) %>%
arrange(sitio, -tasa_registro)
tasa_registro
tasa_registro %>%
group_by(sitio, especie) %>%
summarise(mean(tasa_registro), sd(tasa_registro))
tasa_registro %>%
group_by(sitio, especie)
tasa_registro %>%
group_by(sitio, especie) %>%
summarise(mean(tasa_registro), sd(tasa_registro))
tasa_registro %>%
group_by( especie) %>%
summarise(mean(tasa_registro), sd(tasa_registro))
tasa_registro <- data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tasa_registro = round(cantidad_de_registros/esfuerzo_total, 3)) %>%
select(sitio, especie, tasa_registro) %>%
arrange(sitio, -tasa_registro)
paged_table(tasa_registro)
tasa_registro <- data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tasa_registro = round(cantidad_de_registros/esfuerzo_total, 4)) %>%
select(sitio, especie, tasa_registro) %>%
arrange(sitio, -tasa_registro)
tasa_registro %>%
group_by( especie) %>%
summarise(mean(tasa_registro), sd(tasa_registro))
tasa_registro <- data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tasa_registro = round(cantidad_de_registros/esfuerzo_total, 4)) %>%
select(sitio, especie, tasa_registro) %>%
arrange(sitio, -tasa_registro)
tasa_registro <- data %>%
select(sitio, especie) %>%
group_by(sitio, especie) %>%
summarise(cantidad_de_registros = n()) %>%
left_join(info_camaras, by = join_by(sitio)) %>%
mutate(tasa_registro = round(cantidad_de_registros/esfuerzo_total, 4)) %>%
select(sitio, especie, tasa_registro) %>%
arrange(sitio, -tasa_registro)
paged_table(tasa_registro)
tasa_registro %>%
group_by( especie) %>%
summarise(mean(tasa_registro), sd(tasa_registro))
tasa_registro %>%
group_by(especie) %>%
summarise(round(mean(tasa_registro), 4), round(sd(tasa_registro), 4))
tasa_registro %>%
group_by(especie) %>%
summarise(promedio_tasa_registro = round(mean(tasa_registro), 4), sd_tasa_registro = round(sd(tasa_registro), 4))
datos_por_ap <- full_join(incidencia_por_ap, tasa_registro)
datos_por_ap
paged_tabledatos_por_ap <- full_join(incidencia_por_ap, tasa_registro)
datos_por_ap <- full_join(incidencia_por_ap, tasa_registro)
rm(paged_tabledatos_por_ap)
write_csv(datos_por_ap, file = "exportados/datos_por_ap.csv")
write_csv(datos_por_ap, file = "exportados/datos_por_ap.csv", comment = "hola")
con <- file("exportados/datos_por_ap.csv", "w")
# Escribir el comentario al principio del archivo
cat(paste("#", comentario, "\n"), file = con)
con <- file("exportados/datos_por_ap.csv", "w")
comentario <- "Hola, este es un comentario en el archivo CSV."
# Escribir el comentario al principio del archivo
cat(paste("#", comentario, "\n"), file = con)
write_csv(datos_por_ap, con, col_names = FALSE)
write_csv(datos_por_ap, file = "exportados/datos_por_ap.csv")
paged_table(datos_por_ap)
especies_por_ap <- data %>%
select(sitio, especie) %>%
group_by(sitio) %>%
distinct() %>%
group_by(sitio, especie) %>%
summarize(n = n()) %>%
ungroup() %>%
spread(sitio, n, fill = 0)
paged_table(especies_por_ap)
library(writexl)
install.packages("writexl")
datos_por_ap
paged_table(tasa_registro_por_especie)
tasa_registro_por_especie <- tasa_registro %>%
group_by(especie) %>%
summarise(promedio_tasa_registro = round(mean(tasa_registro), 4), sd_tasa_registro = round(sd(tasa_registro), 4))
paged_table(tasa_registro_por_especie)
full_join(incidencia_por_especie, tasa_registro_por_especie)
incidencia_por_ap <- data %>%
select(sitio, camara, especie) %>% # Me quedo solo con las columnas de interés
group_by(sitio, especie) %>%
summarize(num_camaras = n_distinct(camara)) %>% # Me quedo con la cantidad de cámaras que tuvo registro de cada especie, por área protegida.
left_join(info_camaras, by = join_by(sitio)) %>% # Asocio esos datos con la información de cada cámara (esfuerzo y total de cámaras utilizadas)
group_by(sitio, especie) %>%
mutate(incidencia = round((num_camaras/n_camaras_totales)*100, 2)) %>%  # Calculo incidencia
select(sitio, especie, incidencia) %>%
arrange(sitio, -incidencia)
incidencia_por_especie <- incidencia_por_ap %>%
select(sitio, especie, incidencia) %>%
group_by(especie) %>%
summarise(promedio_incidencia = round(mean(incidencia),2) , sd_incidencia = round(sd(incidencia),2)) %>%
arrange(-promedio_incidencia)
full_join(incidencia_por_especie, tasa_registro_por_especie)
write_xlsx
writexl::xl_formula()
library(writexl)
write_xlsx
write_xlsx(c(especies_por_ap, datos_por_ap, incidencia_tasa_por_especie), path = "exportados/datos.csv")
incidencia_tasa_por_especie <- full_join(incidencia_por_especie, tasa_registro_por_especie)
write_xlsx(c(especies_por_ap, datos_por_ap, incidencia_tasa_por_especie), path = "exportados/datos.csv")
write_xlsx(list(especies_por_ap, datos_por_ap, incidencia_tasa_por_especie), path = "exportados/datos.csv")
write_xlsx(list(especies_por_ap, datos_por_ap, incidencia_tasa_por_especie), path = "exportados/datos.csv")
write_xlsx(list(especies_por_ap, datos_por_ap, incidencia_tasa_por_especie), path = "exportados/datos.xslx")
write_xlsx(list(especies_por_ap, datos_por_ap, incidencia_tasa_por_especie), path = "exportados/datos.xlsx")
